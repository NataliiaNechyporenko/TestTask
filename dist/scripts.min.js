"use strict";console.log("hello!");var commentUrl="http://frontend-test.pingbull.com/pages/ns.nechyporenko@gmail.com/comments",comments=document.querySelector(".comments"),buttons={replyBtn:function(e){var t=e.target.id;document.getElementById("add"+t).style.display="block"},cancelReplyBtn:function(e){var t=e.target.id.slice(11),n=document.getElementById("addreplyTo"+t);console.log(n),n.style.display="none"},addCommentBtn:function(e){addComment(e)}};function renderComment(t){if(t.children){var e=t.children.map(function(e){return e.to=t.author.name,renderReply(e)}).join("");t.replyes=e}var n=_.template(document.getElementById("comment-template").innerHTML)(t),o=document.createElement("div");o.setAttribute("id","comment-"+t.id),o.innerHTML=n,comments.appendChild(o)}function renderReply(e){var t=_.template(document.getElementById("reply-template").innerHTML),n=document.createElement("div");return n.setAttribute("id","reply-"+e.id),n.innerHTML=t(e),n.innerHTML}var getComments=function(){fetch(commentUrl).then(function(e){if(e.ok)return e.json();throw new Error("Error fetching"+e.statusText)}).then(function(e){comments.innerHTML="",document.querySelector("#commentText").innerHTML="",e.forEach(function(e){renderComment(e)})}).catch(function(e){return console.log(e)})},btnHandler=function(){var e=event.target;for(var t in buttons)e.className.includes(t)&&buttons[t](event)};function addComment(){console.log("clicked send");var e={},t=document.querySelector("#commentText").value;t&&(e.headers={"Content-Type":"application/json"},e.method="POST",e.body=JSON.stringify({content:t}),fetch(commentUrl,e).then(function(e){if(!e.ok)throw new Error("Error fetching data. Response status: "+e.status+" : "+e.statusText);e.json()}).then(getComments()).then(window.location.reload()).catch(function(e){console.error("Error: ",e)}))}document.addEventListener("click",btnHandler),getComments();